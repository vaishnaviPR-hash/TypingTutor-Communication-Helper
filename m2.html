<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Module 2 ‚Äì Learn Words</title>

  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet" />

  <style>
    body, html {
      height: 100%;
      margin: 0;
      font-family: 'Poppins', Arial, sans-serif;
      background: #e3f2fd;
      overflow: hidden;
    }

    /* ===== APP SCALE CONTAINER ===== */
    #app-scale {
      width: 1280px;
      height: 800px;
      transform-origin: top left;
      background: #ffffff;
    }

    /* ===== HEADER ===== */
    .lesson-header {
      height: 18%;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      padding: 20px 30px;
      background: #90caf9;
      border-bottom: 4px solid #1a237e;
      user-select: none;
    }

    .lesson-text {
      font-size: 32px;
      font-weight: 600;
      color: #0d1b47;
      margin-bottom: 10px;
      text-align: center;
      letter-spacing: 0.05em;
    }

    .typed-word {
      font-size: 48px;
      font-weight: 700;
      color: #1a237e;
      letter-spacing: 0.1em;
      min-height: 60px;
    }

    .lesson-buttons {
      display: flex;
      gap: 15px;
      width: 100%;
      justify-content: flex-end;
      padding-right: 30px;
    }

    .lesson-btn {
      padding: 12px 20px;
      font-size: 18px;
      border-radius: 10px;
      border: 3px solid #1a237e;
      background: #bbdefb;
      color: #1a237e;
      cursor: pointer;
    }

    /* ===== KEYBOARD ===== */
    .keyboard-section {
      height: 82%;
      display: flex;
      flex-direction: column;
      padding: 20px;
      background: #ffffff;
      box-sizing: border-box;
    }

    .keyboard-grid {
      display: flex;
      flex-direction: column;
      gap: 10px;
      width: 100%;
      height: 100%;
      justify-content: center;
    }

    .key-row {
      display: flex;
      gap: 10px;
      justify-content: center;
      flex: 1;
    }

    .key-btn {
      flex: 1;
      min-width: 80px;
      max-width: 140px;
      font-size: 52px;
      font-weight: bold;
      border: 3px solid #1a237e;
      border-radius: 12px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #bbdefb;
      color: #1a237e;
      user-select: none;
      transition: transform 0.15s ease;
    }

    .key-btn.space-key { flex: 3; max-width: 500px; }
    .key-btn.backspace-key { flex: 2; max-width: 280px; font-size: 40px; }

    .key-btn.highlight {
      background-color: #ffeb3b;
      border-color: #fbc02d;
      transform: scale(1.08);
    }

    .key-btn.pressed-animation {
      transform: scale(0.94);
      background-color: #ffe066;
    }

    /* ===== CONTROLS ===== */
    .control-bar {
      display: flex;
      gap: 15px;
      justify-content: center;
      margin-top: 10px;
    }

    .control-btn {
      width: 70px;
      height: 70px;
      font-size: 32px;
      border-radius: 12px;
      border: 3px solid #1a237e;
      background: #bbdefb;
      color: #1a237e;
      cursor: pointer;
    }
  </style>
</head>

<body>
<div id="app-scale">

  <!-- HEADER -->
  <header class="lesson-header">
    <div class="lesson-text" id="instruction">Type the word:</div>
    <div class="typed-word" id="typedWord"></div>

    <div class="lesson-buttons">
      <button class="lesson-btn" onclick="location.href='learningMode.html'">‚¨Ö Menu</button>
      <button class="lesson-btn" id="skipBtn">Skip</button>
    </div>
  </header>

  <!-- KEYBOARD -->
  <section class="keyboard-section">
    <div class="keyboard-grid">
      <div class="key-row" id="row1"></div>
      <div class="key-row" id="row2"></div>
      <div class="key-row" id="row3"></div>
      <div class="key-row" id="row4"></div>
      <div class="key-row" id="row5"></div>
    </div>

    <div class="control-bar">
      <button class="control-btn" id="speakBtn">üîä</button>
      <button class="control-btn" id="soundBtn">üîî</button>
      <button class="control-btn" id="clearBtn">üóëÔ∏è</button>
    </div>
  </section>

</div>

<script>
  /* ===== AUTO SCALE ===== */
  function scaleApp() {
    const app = document.getElementById('app-scale');
    const scaleX = window.innerWidth / 1280;
    const scaleY = window.innerHeight / 800;
    const scale = Math.min(scaleX, scaleY);
    app.style.transform = `scale(${scale})`;
  }

  window.addEventListener('load', scaleApp);
  window.addEventListener('resize', scaleApp);

  /* ===== ORIGINAL LOGIC ===== */
  const keyboardLayout = [
    ['A','B','C','D','E','F','G'],
    ['H','I','J','K','L','M','N'],
    ['O','P','Q','R','S','T'],
    ['U','V','W','X','Y','Z'],
    ['SPACE','BACKSPACE']
  ];

  const words = [
    'CAT','DOG','SUN','FUN','MAP','HAT','RUN','JUMP','BOOK','TREE',
    'BALL','FISH','CUP','MOON','STAR','SHIP','BIRD','RAIN','SNOW',
    'LOVE','HOME','FROG','WIND','ROCK','ROAD','COW','PIG','HEN','ANT'
  ];

  let currentWord = '';
  let currentLetterIndex = 0;
  let typedLetters = '';
  let soundEnabled = true;

  const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
  const speechSynth = window.speechSynthesis;

  function buildKeyboard() {
    keyboardLayout.forEach((row, i) => {
      const rowEl = document.getElementById(`row${i+1}`);
      row.forEach(key => {
        const btn = document.createElement('button');
        btn.className = 'key-btn';
        btn.textContent = key === 'BACKSPACE' ? '‚å´' : key;
        btn.dataset.key = key;
        if (key === 'SPACE') btn.classList.add('space-key');
        if (key === 'BACKSPACE') btn.classList.add('backspace-key');
        btn.onclick = () => handlePress(key, btn);
        rowEl.appendChild(btn);
      });
    });
  }

  function nextWord() {
    currentWord = words[Math.floor(Math.random() * words.length)];
    currentLetterIndex = 0;
    typedLetters = '';
    updateDisplay();
    highlightKey();
    speak(`Type the word ${currentWord}`);
  }

  function updateDisplay() {
    typedWord.textContent = typedLetters.padEnd(currentWord.length, '_');
  }

  function highlightKey() {
    document.querySelectorAll('.key-btn').forEach(b => b.classList.remove('highlight'));
    const btn = document.querySelector(`[data-key="${currentWord[currentLetterIndex]}"]`);
    if (btn) btn.classList.add('highlight');
  }

  function handlePress(key, btn) {
    if (audioCtx.state === 'suspended') audioCtx.resume();
    if (key !== currentWord[currentLetterIndex]) return;

    btn.classList.add('pressed-animation');
    typedLetters += key;
    updateDisplay();

    setTimeout(() => {
      btn.classList.remove('pressed-animation');
      currentLetterIndex++;
      if (currentLetterIndex < currentWord.length) {
        highlightKey();
      } else {
        speak(`Good job! You typed ${currentWord}`);
        setTimeout(nextWord, 1200);
      }
    }, 350);
  }

  function speak(text) {
    speechSynth.cancel();
    speechSynth.speak(new SpeechSynthesisUtterance(text));
  }

  document.getElementById('skipBtn').onclick = () => location.href = 'learningMode.html';
  document.getElementById('clearBtn').onclick = () => { typedLetters=''; currentLetterIndex=0; updateDisplay(); highlightKey(); };
  document.getElementById('soundBtn').onclick = () => soundEnabled = !soundEnabled;
  document.getElementById('speakBtn').onclick = () => speak(typedWord.textContent.replace(/_/g,''));

  buildKeyboard();
  nextWord();
</script>
</body>
</html>
